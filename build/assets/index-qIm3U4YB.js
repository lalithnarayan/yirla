import{Q as ne,T as Oe,U as Ue,V as Ve,K as ze,g as qe,j as e,$ as Z,r as H,f as z,W as ie,Z as Be,d as Ze,X as Xe,a0 as Ge,G as Je,w as de}from"./index-sFzf4xgK.js";import{A as _e}from"./AdaptableCard-ZmpuYt9J.js";import{C as Qe}from"./Views-cMR82yL4.js";import{D as Ke}from"./DoubleSidedImage-xM8jCzal.js";import{C as De}from"./Card-0NcWSoxi.js";import{A as le}from"./index-l28G_51M.js";import{B as C}from"./Button-7VCVZJfX.js";import{t as We,N as et}from"./Notification-Osm0sSHx.js";import{C as ye}from"./ConfirmDialog-dUTTJxAI.js";import{F as tt,a as at,b as st,c as rt}from"./index.esm-iiyI-toU.js";import{a as ot,U as nt,X as it,ac as lt,ad as me,ae as ct,a0 as dt,af as Ce,ag as mt}from"./index.esm-a15joBQq.js";import{d as ut,e as pt,f as xt}from"./CrmService-ounufnHu.js";import{D as ht}from"./Drawer-ERN9elZs.js";import{T as Ne}from"./index-3yIQZUm3.js";import{c as j,d as b,F as ve,a as Me,b as ke}from"./formik.esm-uH6H_cO4.js";import{c as we,a as g}from"./index.esm-ng5xLdUg.js";import{D as ft}from"./index-svCEv1cS.js";import{I as F}from"./Input-54qFW4_N.js";import{U as jt}from"./Upload-Tsw-ok4K.js";import{e as gt,f as bt,g as Dt,h as yt}from"./index.esm-PEPNg8t8.js";import{T as Pe}from"./index-U7R5GIaq.js";import{B as Ct}from"./Badge-N86Ykf_U.js";import{c as Nt,u as vt,f as ue,g as Mt,a as kt}from"./index-7lD32DxE.js";import{N as Se}from"./react-number-format.es-2TFZlsyx.js";import{T as Fe}from"./Tag-lEthrBg-.js";import{D as wt}from"./Dialog-4z8jxMEB.js";import{F as Pt}from"./FormCustomFormatInput-d-MIUsb1.js";import{F as pe}from"./FormPatternInput-k0HCM3pW.js";import{i as St}from"./isLastChild-6BXlVJ47.js";import"./useMergeRef-Rt_Crb27.js";import"./Tooltip-2HBl8IKw.js";import"./floating-ui.react-xe1dPT16.js";import"./floating-ui.dom-KU0eYpRY.js";import"./index-F1ElV9AB.js";import"./motion-JMywUYCu.js";import"./context-_X_Ia2Rl.js";import"./chainedFunction-ltcSYACe.js";import"./StatusIcon-L39cXky5.js";import"./CloseButton-Lwp70ThL.js";import"./index-PQBKoFWY.js";import"./index-mu0NPuvO.js";import"./useControllableState-vYcyW9Gn.js";import"./RangeCalendar-VdZRgz_Z.js";import"./TimeInput-CVdDVJm6.js";import"./useUniqueId-PxbSI7-8.js";import"./useDidUpdate-a_uQBhDP.js";import"./isNil-jxFxtNPR.js";import"./index.esm-faGim_ZV.js";const _="crmCustomerDetails",oe=ne(_+"/getCustomer",async t=>(await ut(t)).data),Ft=ne(_+"/deleteCustomer",async t=>(await pt(t)).data),Yt=ne(_+"/putCustomer",async t=>(await xt(t)).data),It={loading:!0,profileData:{},subscriptionData:[],paymentHistoryData:[],paymentMethodData:[],deletePaymentMethodDialog:!1,editPaymentMethodDialog:!1,editCustomerDetailDialog:!1,selectedCard:{}},Ye=Oe({name:`${_}/state`,initialState:It,reducers:{updatePaymentMethodData:(t,s)=>{t.paymentMethodData=s.payload},updateProfileData:(t,s)=>{t.profileData=s.payload},openDeletePaymentMethodDialog:t=>{t.deletePaymentMethodDialog=!0},closeDeletePaymentMethodDialog:t=>{t.deletePaymentMethodDialog=!1},openEditPaymentMethodDialog:t=>{t.editPaymentMethodDialog=!0},closeEditPaymentMethodDialog:t=>{t.editPaymentMethodDialog=!1},openEditCustomerDetailDialog:t=>{t.editCustomerDetailDialog=!0},closeEditCustomerDetailDialog:t=>{t.editCustomerDetailDialog=!1},updateSelectedCard:(t,s)=>{t.selectedCard=s.payload}},extraReducers:t=>{t.addCase(oe.fulfilled,(s,a)=>{var n,o,r;s.loading=!1,s.profileData=a.payload,s.subscriptionData=((n=a.payload)==null?void 0:n.subscription)||[],s.paymentHistoryData=((o=a.payload)==null?void 0:o.orderHistory)||[],s.paymentMethodData=((r=a.payload)==null?void 0:r.paymentMethod)||[]}).addCase(oe.pending,s=>{s.loading=!0})}}),{updatePaymentMethodData:Ie,updateProfileData:Et,openDeletePaymentMethodDialog:Lt,closeDeletePaymentMethodDialog:xe,openEditPaymentMethodDialog:Tt,closeEditPaymentMethodDialog:Ht,openEditCustomerDetailDialog:Rt,closeEditCustomerDetailDialog:At,updateSelectedCard:he}=Ye.actions,$t=Ye.reducer,Ot=Ue({data:$t}),D=Ve;var Ee={exports:{}};(function(t,s){(function(a,n){t.exports=n()})(ze,function(){var a={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,o=/\d\d/,r=/\d\d?/,c=/\d*[^-_:/,()\s\d]+/,i={},u=function(l){return(l=+l)+(l>68?1900:2e3)},d=function(l){return function(m){this[l]=+m}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(l){(this.zone||(this.zone={})).offset=function(m){if(!m||m==="Z")return 0;var p=m.match(/([+-]|\d\d)/g),x=60*p[1]+(+p[2]||0);return x===0?0:p[0]==="+"?-x:x}(l)}],f=function(l){var m=i[l];return m&&(m.indexOf?m:m.s.concat(m.f))},N=function(l,m){var p,x=i.meridiem;if(x){for(var v=1;v<=24;v+=1)if(l.indexOf(x(v,0,m))>-1){p=v>12;break}}else p=l===(m?"pm":"PM");return p},y={A:[c,function(l){this.afternoon=N(l,!1)}],a:[c,function(l){this.afternoon=N(l,!0)}],S:[/\d/,function(l){this.milliseconds=100*+l}],SS:[o,function(l){this.milliseconds=10*+l}],SSS:[/\d{3}/,function(l){this.milliseconds=+l}],s:[r,d("seconds")],ss:[r,d("seconds")],m:[r,d("minutes")],mm:[r,d("minutes")],H:[r,d("hours")],h:[r,d("hours")],HH:[r,d("hours")],hh:[r,d("hours")],D:[r,d("day")],DD:[o,d("day")],Do:[c,function(l){var m=i.ordinal,p=l.match(/\d+/);if(this.day=p[0],m)for(var x=1;x<=31;x+=1)m(x).replace(/\[|\]/g,"")===l&&(this.day=x)}],M:[r,d("month")],MM:[o,d("month")],MMM:[c,function(l){var m=f("months"),p=(f("monthsShort")||m.map(function(x){return x.slice(0,3)})).indexOf(l)+1;if(p<1)throw new Error;this.month=p%12||p}],MMMM:[c,function(l){var m=f("months").indexOf(l)+1;if(m<1)throw new Error;this.month=m%12||m}],Y:[/[+-]?\d+/,d("year")],YY:[o,function(l){this.year=u(l)}],YYYY:[/\d{4}/,d("year")],Z:h,ZZ:h};function Q(l){var m,p;m=l,p=i&&i.formats;for(var x=(l=m.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(A,E,S){var k=S&&S.toUpperCase();return E||p[S]||a[S]||p[k].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(L,T,$){return T||$.slice(1)})})).match(n),v=x.length,M=0;M<v;M+=1){var R=x[M],P=y[R],Y=P&&P[0],I=P&&P[1];x[M]=I?{regex:Y,parser:I}:R.replace(/^\[|\]$/g,"")}return function(A){for(var E={},S=0,k=0;S<v;S+=1){var L=x[S];if(typeof L=="string")k+=L.length;else{var T=L.regex,$=L.parser,X=A.slice(k),U=T.exec(X)[0];$.call(E,U),A=A.replace(U,"")}}return function(O){var w=O.afternoon;if(w!==void 0){var V=O.hours;w?V<12&&(O.hours+=12):V===12&&(O.hours=0),delete O.afternoon}}(E),E}}return function(l,m,p){p.p.customParseFormat=!0,l&&l.parseTwoDigitYear&&(u=l.parseTwoDigitYear);var x=m.prototype,v=x.parse;x.parse=function(M){var R=M.date,P=M.utc,Y=M.args;this.$u=P;var I=Y[1];if(typeof I=="string"){var A=Y[2]===!0,E=Y[3]===!0,S=A||E,k=Y[2];E&&(k=Y[2]),i=this.$locale(),!A&&k&&(i=p.Ls[k]),this.$d=function(X,U,O){try{if(["x","X"].indexOf(U)>-1)return new Date((U==="X"?1e3:1)*X);var w=Q(U)(X),V=w.year,G=w.month,Te=w.day,He=w.hours,Re=w.minutes,Ae=w.seconds,$e=w.milliseconds,ce=w.zone,K=new Date,W=Te||(V||G?1:K.getDate()),ee=V||K.getFullYear(),J=0;V&&!G||(J=G>0?G-1:K.getMonth());var te=He||0,ae=Re||0,se=Ae||0,re=$e||0;return ce?new Date(Date.UTC(ee,J,W,te,ae,se,re+60*ce.offset*1e3)):O?new Date(Date.UTC(ee,J,W,te,ae,se,re)):new Date(ee,J,W,te,ae,se,re)}catch{return new Date("")}}(R,I,P),this.init(),k&&k!==!0&&(this.$L=this.locale(k).$L),S&&R!=this.format(I)&&(this.$d=new Date("")),i={}}else if(I instanceof Array)for(var L=I.length,T=1;T<=L;T+=1){Y[1]=I[T-1];var $=p.apply(this,Y);if($.isValid()){this.$d=$.$d,this.$L=$.$L,this.init();break}T===L&&(this.$d=new Date(""))}else v.call(this,M)}}})})(Ee);var Ut=Ee.exports;const Vt=qe(Ut),zt=t=>{const{touched:s,errors:a}=t;return e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:a.upload&&s.upload,errorMessage:a.upload,children:e.jsx(b,{name:"img",children:({field:n,form:o})=>{const r=n.value?{src:n.value}:{};return e.jsx("div",{className:"flex justify-center",children:e.jsx(jt,{className:"cursor-pointer",showList:!1,uploadLimit:1,onChange:c=>o.setFieldValue(n.name,URL.createObjectURL(c[0])),onFileRemove:c=>o.setFieldValue(n.name,URL.createObjectURL(c[0])),children:e.jsx(le,{className:"border-2 border-white dark:border-gray-800 shadow-lg",size:100,shape:"circle",icon:e.jsx(ot,{}),...r})})})}})}),e.jsx(j,{label:"Name",invalid:a.name&&s.name,errorMessage:a.name,children:e.jsx(b,{type:"text",autoComplete:"off",name:"name",placeholder:"Name",component:F,prefix:e.jsx(nt,{className:"text-xl"})})}),e.jsx(j,{label:"Email",invalid:a.email&&s.email,errorMessage:a.email,children:e.jsx(b,{type:"email",autoComplete:"off",name:"email",placeholder:"Email",component:F,prefix:e.jsx(it,{className:"text-xl"})})}),e.jsx(j,{label:"Location",invalid:a.location&&s.location,errorMessage:a.location,children:e.jsx(b,{type:"text",autoComplete:"off",name:"location",placeholder:"Location",component:F,prefix:e.jsx(lt,{className:"text-xl"})})}),e.jsx(j,{label:"Phone Number",invalid:a.phoneNumber&&s.phoneNumber,errorMessage:a.phoneNumber,children:e.jsx(b,{type:"text",autoComplete:"off",name:"phoneNumber",placeholder:"Phone Number",component:F,prefix:e.jsx(me,{className:"text-xl"})})}),e.jsx(j,{label:"Title",invalid:a.title&&s.title,errorMessage:a.title,children:e.jsx(b,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:F,prefix:e.jsx(me,{className:"text-xl"})})}),e.jsx(j,{label:"Birthday",invalid:a.birthday&&s.birthday,errorMessage:a.birthday,children:e.jsx(b,{name:"birthday",placeholder:"Date",children:({field:n,form:o})=>e.jsx(ft,{field:n,form:o,value:n.value,inputPrefix:e.jsx(ct,{className:"text-xl"}),onChange:r=>{o.setFieldValue(n.name,r)}})})})]})},qt=t=>{const{touched:s,errors:a}=t;return e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Facebook link",invalid:a.facebook&&s.facebook,errorMessage:a.facebook,children:e.jsx(b,{type:"text",autoComplete:"off",name:"facebook",placeholder:"URL",component:F,prefix:e.jsx(gt,{className:"text-xl text-[#1773ea]"})})}),e.jsx(j,{label:"Twitter link",invalid:a.twitter&&s.twitter,errorMessage:a.twitter,children:e.jsx(b,{type:"text",autoComplete:"off",name:"twitter",placeholder:"URL",component:F,prefix:e.jsx(bt,{className:"text-xl text-[#1da1f3]"})})}),e.jsx(j,{label:"Pinterest link",invalid:a.pinterest&&s.pinterest,errorMessage:a.pinterest,children:e.jsx(b,{type:"text",autoComplete:"off",name:"pinterest",placeholder:"URL",component:F,prefix:e.jsx(Dt,{className:"text-xl text-[#df0018]"})})}),e.jsx(j,{label:"LinkedIn link",invalid:a.linkedIn&&s.linkedIn,errorMessage:a.linkedIn,children:e.jsx(b,{type:"text",autoComplete:"off",name:"linkedIn",placeholder:"URL",component:F,prefix:e.jsx(yt,{className:"text-xl text-[#0077b5]"})})})]})};Z.extend(Vt);const Bt=we().shape({email:g().email("Invalid email").required("Email Required"),name:g().required("User Name Required"),location:g(),title:g(),phoneNumber:g().matches(/^((\+[1-9]{1,4}[ -]?)|(\([0-9]{2,3}\)[ -]?)|([0-9]{2,4})[ -]?)*?[0-9]{3,4}[ -]?[0-9]{3,4}$/,"Phone number is not valid"),birthday:g(),facebook:g(),twitter:g(),pinterest:g(),linkedIn:g(),img:g()}),{TabNav:fe,TabList:Zt,TabContent:je}=Ne,Le=H.forwardRef((t,s)=>{var o,r,c,i,u,d,h,f;const{customer:a,onFormSubmit:n}=t;return e.jsx(ve,{innerRef:s,initialValues:{name:a.name||"",email:a.email||"",img:a.img||"",location:((o=a==null?void 0:a.personalInfo)==null?void 0:o.location)||"",title:((r=a==null?void 0:a.personalInfo)==null?void 0:r.title)||"",phoneNumber:((c=a==null?void 0:a.personalInfo)==null?void 0:c.phoneNumber)||"",birthday:((i=a==null?void 0:a.personalInfo)==null?void 0:i.birthday)&&Z(a.personalInfo.birthday,"DD/MM/YYYY").toDate(),facebook:((u=a==null?void 0:a.personalInfo)==null?void 0:u.facebook)||"",twitter:((d=a==null?void 0:a.personalInfo)==null?void 0:d.twitter)||"",pinterest:((h=a==null?void 0:a.personalInfo)==null?void 0:h.pinterest)||"",linkedIn:((f=a==null?void 0:a.personalInfo)==null?void 0:f.linkedIn)||""},validationSchema:Bt,onSubmit:(N,{setSubmitting:y})=>{n==null||n(N),y(!1)},children:({touched:N,errors:y})=>e.jsx(Me,{children:e.jsx(ke,{children:e.jsxs(Ne,{defaultValue:"personalInfo",children:[e.jsxs(Zt,{children:[e.jsx(fe,{value:"personalInfo",children:"Personal Info"}),e.jsx(fe,{value:"social",children:"Social"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx(je,{value:"personalInfo",children:e.jsx(zt,{touched:N,errors:y})}),e.jsx(je,{value:"social",children:e.jsx(qt,{touched:N,errors:y})})]})]})})})})});Le.displayName="CustomerForm";const Xt=({onSaveClick:t,onCancel:s})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(C,{size:"sm",className:"mr-2",onClick:s,children:"Cancel"}),e.jsx(C,{size:"sm",variant:"solid",onClick:t,children:"Save"})]}),Gt=()=>{const t=z(),s=H.useRef(null),a=D(i=>i.crmCustomerDetails.data.editCustomerDetailDialog),n=D(i=>i.crmCustomerDetails.data.profileData),o=()=>{t(At())},r=()=>{var i;(i=s.current)==null||i.submitForm()},c=i=>{const u=ie(n),{name:d,birthday:h,email:f,img:N,location:y,title:Q,phoneNumber:l,facebook:m,twitter:p,pinterest:x,linkedIn:v}=i,M={name:d,email:f,img:N},R={location:y,title:Q,birthday:Z(h).format("DD/MM/YYYY"),phoneNumber:l,facebook:m,twitter:p,pinterest:x,linkedIn:v};u.personalInfo={...u.personalInfo,...R};const P={...u,...M};t(Et(P)),t(Yt(P)),o()};return e.jsx(ht,{isOpen:a,closable:!1,bodyClass:"p-0",footer:e.jsx(Xt,{onCancel:o,onSaveClick:r}),onClose:o,onRequestClose:o,children:e.jsx(Le,{ref:s,customer:n,onFormSubmit:c})})},q=({title:t,value:s})=>e.jsxs("div",{children:[e.jsx("span",{children:t}),e.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",children:s})]}),Jt=({id:t})=>{const s=z(),[a,n]=H.useState(!1),o=Be(),r=()=>{n(!1)},c=()=>{n(!0)},i=()=>{n(!1),t&&s(Ft({id:t})),o("/app/crm/customers"),We.push(e.jsx(et,{title:"Successfuly Deleted",type:"success",children:"Customer successfuly deleted"}))},u=()=>{s(Rt())};return e.jsxs(e.Fragment,{children:[e.jsx(C,{block:!0,icon:e.jsx(dt,{}),onClick:c,children:"Delete"}),e.jsx(C,{block:!0,icon:e.jsx(Ce,{}),variant:"solid",onClick:u,children:"Edit"}),e.jsx(ye,{isOpen:a,type:"danger",title:"Delete customer",confirmButtonColor:"red-600",onClose:r,onRequestClose:r,onCancel:r,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this customer? All record related to this customer will be deleted as well. This action cannot be undone."})}),e.jsx(Gt,{})]})},_t=({data:t={}})=>{var s,a,n,o;return e.jsx(De,{children:e.jsxs("div",{className:"flex flex-col xl:justify-between h-full 2xl:min-w-[360px] mx-auto",children:[e.jsxs("div",{className:"flex xl:flex-col items-center gap-4",children:[e.jsx(le,{size:90,shape:"circle",src:t.img}),e.jsx("h4",{className:"font-bold",children:t.name})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-8",children:[e.jsx(q,{title:"Email",value:t.email}),e.jsx(q,{title:"Phone",value:(s=t.personalInfo)==null?void 0:s.phoneNumber}),e.jsx(q,{title:"Location",value:(a=t.personalInfo)==null?void 0:a.location}),e.jsx(q,{title:"Date of birth",value:(n=t.personalInfo)==null?void 0:n.birthday}),e.jsx(q,{title:"Title",value:(o=t.personalInfo)==null?void 0:o.title}),e.jsxs("div",{className:"mb-7",children:[e.jsx("span",{children:"Social"}),e.jsxs("div",{className:"flex mt-4",children:[e.jsx(C,{className:"mr-2",shape:"circle",size:"sm",icon:e.jsx(tt,{className:"text-[#1773ea]"})}),e.jsx(C,{className:"mr-2",shape:"circle",size:"sm",icon:e.jsx(at,{className:"text-[#1da1f3]"})}),e.jsx(C,{className:"mr-2",shape:"circle",size:"sm",icon:e.jsx(st,{className:"text-[#0077b5]"})}),e.jsx(C,{className:"mr-2",shape:"circle",size:"sm",icon:e.jsx(rt,{className:"text-[#df0018]"})})]})]})]}),e.jsx("div",{className:"mt-4 flex flex-col xl:flex-row gap-2",children:e.jsx(Jt,{id:t.id})})]})})},{Tr:ge,Th:Qt,Td:Kt,THead:Wt,TBody:ea,Sorter:ta}=Pe,aa={paid:"bg-emerald-500",pending:"bg-amber-400"},B=Nt(),sa=[B.accessor("id",{header:"Reference",cell:t=>{const s=t.row.original;return e.jsx("div",{children:e.jsx("span",{className:"cursor-pointer",children:s.id})})}}),B.accessor("item",{header:"Product"}),B.accessor("status",{header:"Status",cell:t=>{const s=t.row.original;return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ct,{className:aa[s.status]}),e.jsx("span",{className:"ml-2 rtl:mr-2 capitalize",children:s.status})]})}}),B.accessor("date",{header:"Date",cell:t=>{const s=t.row.original;return e.jsx("div",{className:"flex items-center",children:Z.unix(s.date).format("MM/DD/YYYY")})}}),B.accessor("amount",{header:"Amount",cell:t=>{const s=t.row.original;return e.jsx("div",{className:"flex items-center",children:e.jsx(Se,{displayType:"text",value:(Math.round(s.amount*100)/100).toFixed(2),prefix:"$",thousandSeparator:!0})})}})],ra=()=>{const t=D(o=>o.crmCustomerDetails.data.paymentHistoryData),[s,a]=H.useState([]),n=vt({data:t,columns:sa,state:{sorting:s},onSortingChange:a,getCoreRowModel:Mt(),getSortedRowModel:kt()});return e.jsxs("div",{className:"mb-8",children:[e.jsx("h6",{className:"mb-4",children:"Payment History"}),e.jsxs(Pe,{children:[e.jsx(Wt,{children:n.getHeaderGroups().map(o=>e.jsx(ge,{children:o.headers.map(r=>e.jsx(Qt,{colSpan:r.colSpan,children:r.isPlaceholder?null:e.jsxs("div",{className:r.column.getCanSort()?"cursor-pointer select-none":"",onClick:r.column.getToggleSortingHandler(),children:[ue(r.column.columnDef.header,r.getContext()),e.jsx(ta,{sort:r.column.getIsSorted()})]})},r.id))},o.id))}),e.jsx(ea,{children:n.getRowModel().rows.slice(0,10).map(o=>e.jsx(ge,{children:o.getVisibleCells().map(r=>e.jsx(Kt,{children:ue(r.column.columnDef.cell,r.getContext())},r.id))},o.id))})]})]})},oa=()=>{const[t,s]=H.useState(!0),a=D(r=>r.crmCustomerDetails.data.subscriptionData),n=H.useCallback(()=>{s(!1)},[]),o=H.useCallback(()=>{s(!0)},[]);return e.jsxs("div",{className:"mb-8",children:[e.jsx("h6",{className:"mb-4",children:"Subscription"}),a.map(r=>e.jsx(De,{bordered:!0,className:"mb-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{children:e.jsx(le,{className:"bg-emerald-500",shape:"circle",icon:e.jsx(mt,{})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h6",{children:r.plan}),e.jsx(Fe,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100 rounded-md border-0 mx-2",children:e.jsx("span",{className:"capitalize",children:r.status})})]}),e.jsxs("div",{children:[e.jsxs("span",{children:["Billing ",r.billing]}),e.jsx("span",{children:" | "}),e.jsxs("span",{children:["Next payment on"," ",Z.unix(r.nextPaymentDate).format("MM/DD/YYYY")]}),e.jsxs("span",{children:[e.jsx("span",{className:"mx-1",children:"for"}),e.jsx(Se,{className:"font-semibold text-gray-900 dark:text-gray-100",displayType:"text",value:(Math.round(r.amount*100)/100).toFixed(2),prefix:"$",thousandSeparator:!0})]})]})]})]}),e.jsxs("div",{className:"flex",children:[t&&e.jsx(C,{size:"sm",variant:"plain",onClick:n,children:"Cancel plan"}),e.jsxs(C,{size:"sm",className:"ml-2 rtl:mr-2",onClick:o,children:[t?"Update":"Subscribe"," Plan"]})]})]})},r.plan))]})},na=we().shape({cardHolderName:g().required("Card holder name required"),ccNumber:g().required("Credit card number required").matches(/^(?:4[0-9]{12}(?:[0-9]{3})?|[25][1-7][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,"Invalid credit card number"),cardExpiry:g().required("Card holder name required").matches(/^(0[1-9]|1[0-2])\/?([0-9]{4}|[0-9]{2})$/,"Invalid Date"),code:g().required().matches(/^[0-9]{3}$/,"Invalid CVV")});function be(t,s){return t.length===1&&t[0]>s[0]&&(t="0"+t),t.length===2&&(Number(t)===0?t="01":t>s&&(t=s)),t}function ia(t){const s=be(t.substring(0,2),"12"),a=be(t.substring(2,4),"31");return s+(a.length?"/"+a:"")}const la=()=>{const t=z(),s=D(i=>i.crmCustomerDetails.data.selectedCard),a=D(i=>i.crmCustomerDetails.data.paymentMethodData),n=D(i=>i.crmCustomerDetails.data.editPaymentMethodDialog),o=D(i=>i.crmCustomerDetails.data.selectedCard),r=i=>{let u=ie(a)||[];const{cardHolderName:d,ccNumber:h,cardExpiry:f}=i,N={cardHolderName:d,last4Number:h.substr(h.length-4),expYear:f.substr(f.length-2),expMonth:f.substring(0,2)};u=u.map(y=>(y.last4Number===o.last4Number&&(y={...y,...N}),y)),c(),t(Ie(u))},c=()=>{t(Ht())};return e.jsxs(wt,{isOpen:n,onClose:c,onRequestClose:c,children:[e.jsx("h4",{children:"Edit Credit Card"}),e.jsx("div",{className:"mt-6",children:e.jsx(ve,{initialValues:{cardHolderName:s.cardHolderName||"",ccNumber:"",cardExpiry:(s==null?void 0:s.expMonth)+s.expYear||"",code:""},validationSchema:na,onSubmit:(i,{setSubmitting:u})=>{r(i),u(!1)},children:({touched:i,errors:u})=>e.jsx(Me,{children:e.jsxs(ke,{children:[e.jsx(j,{label:"Card holder name",invalid:u.cardHolderName&&i.cardHolderName,errorMessage:u.cardHolderName,children:e.jsx(b,{type:"text",autoComplete:"off",name:"cardHolderName",component:F})}),e.jsx(j,{label:"Credit Card Number",invalid:u.ccNumber&&i.ccNumber,errorMessage:u.ccNumber,children:e.jsx(b,{name:"ccNumber",children:({field:d,form:h})=>e.jsx(pe,{form:h,field:d,placeholder:"•••• •••• •••• ••••",format:"#### #### #### ####",onValueChange:f=>{h.setFieldValue(d.name,f.value)}})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(j,{label:"Expiration date",invalid:u.cardExpiry&&i.cardExpiry,errorMessage:u.cardExpiry,children:e.jsx(b,{name:"cardExpiry",children:({field:d,form:h})=>e.jsx(Pt,{form:h,field:d,placeholder:"••/••",format:ia,defaultValue:h.values.cardExpiry,onValueChange:f=>{h.setFieldValue(d.name,f.value)}})})}),e.jsx(j,{label:"CVV",invalid:u.code&&i.code,errorMessage:u.code,children:e.jsx(b,{name:"code",children:({field:d,form:h})=>e.jsx(pe,{form:h,field:d,placeholder:"•••",format:"###",onValueChange:f=>{h.setFieldValue(d.name,f.value)}})})})]}),e.jsx(j,{className:"mb-0 text-right",children:e.jsx(C,{block:!0,variant:"solid",type:"submit",children:"Update"})})]})})})})]})},ca=()=>{const t=z(),s=D(c=>c.crmCustomerDetails.data.paymentMethodData),a=D(c=>c.crmCustomerDetails.data.deletePaymentMethodDialog),n=D(c=>c.crmCustomerDetails.data.selectedCard),o=()=>{let c=ie(s)||[];c=c.filter(i=>i.last4Number!==n.last4Number),t(xe()),t(Ie(c))},r=()=>{t(xe())};return e.jsx(ye,{isOpen:a,type:"danger",title:"Remove payment method",confirmButtonColor:"red-600",onClose:r,onRequestClose:r,onCancel:r,onConfirm:o,children:e.jsx("p",{children:" Are you sure you want to remove this payment method? "})})},da=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ma=()=>{const t=z(),s=D(o=>o.crmCustomerDetails.data.paymentMethodData),a=o=>{t(he(o)),t(Tt())},n=o=>{t(he(o)),t(Lt())};return e.jsxs(e.Fragment,{children:[s.length>0&&e.jsxs("div",{children:[e.jsx("h6",{className:"mb-4",children:"Payment Methods"}),e.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600",children:s.map((o,r)=>e.jsxs("div",{className:Ze("flex flex-col lg:flex-row lg:items-center justify-between gap-3 p-4",!St(s,r)&&"border-b border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[o.cardType==="VISA"&&e.jsx("img",{src:"/img/others/img-8.png",alt:"visa"}),o.cardType==="MASTER"&&e.jsx("img",{src:"/img/others/img-9.png",alt:"master"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"text-gray-900 dark:text-gray-100 font-semibold",children:[o.cardHolderName," ••••"," ",o.last4Number]}),o.primary&&e.jsx(Fe,{className:"bg-sky-100 text-sky-600 dark:bg-sky-500/20 dark:text-sky-100 rounded-md border-0 mx-2",children:e.jsxs("span",{className:"capitalize",children:[" ","Primary"," "]})})]}),e.jsxs("span",{children:["Expired"," ",da[parseInt(o.expMonth)-1]," ","20",o.expYear]})]})]}),e.jsxs("div",{className:"flex",children:[e.jsx(C,{className:"mr-2 rtl:ml-2",variant:"plain",size:"sm",onClick:()=>n(o),children:"Delete"}),e.jsx(C,{icon:e.jsx(Ce,{}),size:"sm",onClick:()=>a(o),children:"Edit"})]})]},o.last4Number))})]}),e.jsx(la,{}),e.jsx(ca,{})]})};Xe("crmCustomerDetails",Ot);const ua=()=>{const t=z(),s=Ge(),a=D(r=>r.crmCustomerDetails.data.profileData),n=D(r=>r.crmCustomerDetails.data.loading);H.useEffect(()=>{o()},[]);const o=()=>{const r=s.get("id");r&&t(oe({id:r}))};return e.jsxs(Qe,{className:"h-full",children:[e.jsx(Je,{loading:n,children:!de(a)&&e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4",children:[e.jsx("div",{children:e.jsx(_t,{data:a})}),e.jsx("div",{className:"w-full",children:e.jsxs(_e,{children:[e.jsx(oa,{}),e.jsx(ra,{}),e.jsx(ma,{})]})})]})}),!n&&de(a)&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[e.jsx(Ke,{src:"/img/others/img-2.png",darkModeSrc:"/img/others/img-2-dark.png",alt:"No user found!"}),e.jsx("h3",{className:"mt-8",children:"No user found!"})]})]})},ls=ua;export{ls as default};
