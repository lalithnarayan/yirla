import{j as e,r as f,W as D}from"./index-sFzf4xgK.js";import{c as u,d as g,F as P,a as V,b as O}from"./formik.esm-uH6H_cO4.js";import{u as U,B as N}from"./Button-7VCVZJfX.js";import{u as M,a as q}from"./useControllableState-vYcyW9Gn.js";import{u as A}from"./useDidUpdate-a_uQBhDP.js";import{u as B}from"./useMergeRef-Rt_Crb27.js";import{u as T,a as z}from"./useRootClose-b8-XJ4kM.js";import{u as $}from"./StatusIcon-L39cXky5.js";import{u as E}from"./useUniqueId-PxbSI7-8.js";import{u as H,D as W}from"./Dialog-4z8jxMEB.js";import{S as K}from"./StickyFooter-IZc28Q8E.js";import{C as L}from"./ConfirmDialog-dUTTJxAI.js";import{A as C}from"./AdaptableCard-ZmpuYt9J.js";import{R as G}from"./RichTextEditor-eYzbCh4G.js";import{I as h}from"./Input-54qFW4_N.js";import{N as J}from"./react-number-format.es-2TFZlsyx.js";import{S as y}from"./Select-aeRvqRmw.js";import{C as Q}from"./react-select-creatable.esm-xAB83GKE.js";import{D as I}from"./DoubleSidedImage-xM8jCzal.js";import{U as k}from"./Upload-Tsw-ok4K.js";import{ah as X,ai as Y,a0 as Z}from"./index.esm-a15joBQq.js";import{A as _}from"./index.esm-QfY7KnqH.js";import{c as ee,a as w,b as F}from"./index.esm-ng5xLdUg.js";const se={useCallbackRef:M,useColorLevel:U,useControllableState:q,useDidUpdate:A,useMergeRef:B,useRootClose:T,useTimeout:$,useUncertainRef:z,useUniqueId:E,useWindowSize:H},ae=n=>{const{touched:i,errors:r}=n;return e.jsxs(C,{divider:!0,className:"mb-4",children:[e.jsx("h5",{children:"Basic Information"}),e.jsx("p",{className:"mb-6",children:"Section to config basic product information"}),e.jsx(u,{label:"Product Name",invalid:r.name&&i.name,errorMessage:r.name,children:e.jsx(g,{type:"text",autoComplete:"off",name:"name",placeholder:"Name",component:h})}),e.jsx(u,{label:"Code",invalid:r.productCode&&i.productCode,errorMessage:r.productCode,children:e.jsx(g,{type:"text",autoComplete:"off",name:"productCode",placeholder:"Code",component:h})}),e.jsx(u,{label:"Description",labelClass:"!justify-start",invalid:r.description&&i.description,errorMessage:r.description,children:e.jsx(g,{name:"description",children:({field:s,form:t})=>e.jsx(G,{value:s.value,onChange:a=>t.setFieldValue(s.name,a)})})})]})},R=n=>e.jsx(h,{...n,value:n.field.value,prefix:"$"}),re=n=>e.jsx(h,{...n,value:n.field.value}),te=n=>e.jsx(h,{...n,value:n.field.value}),b=({onValueChange:n,...i})=>e.jsx(J,{customInput:h,type:"text",autoComplete:"off",onValueChange:n,...i}),ie=n=>{const{touched:i,errors:r}=n;return e.jsxs(C,{divider:!0,className:"mb-4",children:[e.jsx("h5",{children:"Pricing"}),e.jsx("p",{className:"mb-6",children:"Section to config product sales information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"SKU",invalid:r.stock&&i.stock,errorMessage:r.stock,children:e.jsx(g,{name:"stock",children:({field:s,form:t})=>e.jsx(b,{form:t,field:s,placeholder:"Stock",customInput:re,onValueChange:a=>{t.setFieldValue(s.name,a.value)}})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"Price",invalid:r.price&&i.price,errorMessage:r.price,children:e.jsx(g,{name:"price",children:({field:s,form:t})=>e.jsx(b,{form:t,field:s,placeholder:"Price",customInput:R,onValueChange:a=>{t.setFieldValue(s.name,a.value)}})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"Bulk Discount Price",invalid:r.bulkDiscountPrice&&i.bulkDiscountPrice,errorMessage:r.bulkDiscountPrice,children:e.jsx(g,{name:"bulkDiscountPrice",children:({field:s,form:t})=>e.jsx(b,{form:t,field:s,placeholder:"Bulk Discount Price",customInput:R,onValueChange:a=>{t.setFieldValue(s.name,a.value)}})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"Tax Rate(%)",invalid:r.taxRate&&i.taxRate,errorMessage:r.taxRate,children:e.jsx(g,{name:"taxRate",children:({field:s,form:t})=>e.jsx(b,{form:t,field:s,placeholder:"Tax Rate",customInput:te,isAllowed:({floatValue:a})=>a<=100,onValueChange:a=>{t.setFieldValue(s.name,a.value)}})})})})]})]})},S=[{label:"Bags",value:"bags"},{label:"Cloths",value:"cloths"},{label:"Devices",value:"devices"},{label:"Shoes",value:"shoes"},{label:"Watches",value:"watches"}],ne=[{label:"trend",value:"trend"},{label:"unisex",value:"unisex"}],oe=n=>{const{values:i={category:"",tags:[]},touched:r,errors:s}=n;return e.jsxs(C,{divider:!0,isLastChild:!0,className:"mb-4",children:[e.jsx("h5",{children:"Organizations"}),e.jsx("p",{className:"mb-6",children:"Section to config the product attribute"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"Category",invalid:s.category&&r.category,errorMessage:s.category,children:e.jsx(g,{name:"category",children:({field:t,form:a})=>e.jsx(y,{field:t,form:a,options:S,value:S.filter(o=>o.value===i.category),onChange:o=>a.setFieldValue(t.name,o==null?void 0:o.value)})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"Tags",invalid:s.tags&&r.tags,errorMessage:s.tags,children:e.jsx(g,{name:"tags",children:({field:t,form:a})=>e.jsx(y,{isMulti:!0,componentAs:Q,field:t,form:a,options:ne,value:i.tags,onChange:o=>a.setFieldValue(t.name,o)})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"Brand",invalid:s.brand&&r.brand,errorMessage:s.brand,children:e.jsx(g,{type:"text",autoComplete:"off",name:"brand",placeholder:"Brand",component:h})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(u,{label:"Vendor",invalid:s.vendor&&r.vendor,errorMessage:s.vendor,children:e.jsx(g,{type:"text",autoComplete:"off",name:"vendor",placeholder:"Vendor",component:h})})})]})]})},le=n=>{const{imgList:i,onImageDelete:r}=n,[s,t]=f.useState({}),[a,o]=f.useState(!1),[c,l]=f.useState(!1),m=p=>{t(p),o(!0)},d=()=>{o(!1),setTimeout(()=>{t({})},300)},x=p=>{t(p),l(!0)},v=()=>{t({}),l(!1)},j=()=>{r==null||r(s),l(!1)};return e.jsxs(e.Fragment,{children:[i.map(p=>e.jsxs("div",{className:"group relative rounded border p-2 flex",children:[e.jsx("img",{className:"rounded max-h-[140px] max-w-full",src:p.img,alt:p.name}),e.jsxs("div",{className:"absolute inset-2 bg-gray-900/[.7] group-hover:flex hidden text-xl items-center justify-center",children:[e.jsx("span",{className:"text-gray-100 hover:text-gray-300 cursor-pointer p-1.5",onClick:()=>m(p),children:e.jsx(X,{})}),e.jsx("span",{className:"text-gray-100 hover:text-gray-300 cursor-pointer p-1.5",onClick:()=>x(p),children:e.jsx(Y,{})})]})]},p.id)),e.jsxs(W,{isOpen:a,onClose:d,onRequestClose:d,children:[e.jsx("h5",{className:"mb-4",children:s.name}),e.jsx("img",{className:"w-full",src:s.img,alt:s.name})]}),e.jsx(L,{isOpen:c,type:"danger",title:"Remove image",confirmButtonColor:"red-600",onClose:v,onRequestClose:v,onCancel:v,onConfirm:j,children:e.jsx("p",{children:" Are you sure you want to remove this image? "})})]})},ce=n=>{const{values:i}=n,r=a=>{let o=!0;const c=["image/jpeg","image/png"],l=5e5;if(a)for(const m of a)c.includes(m.type)||(o="Please upload a .jpeg or .png file!"),m.size>=l&&(o="Upload image cannot more then 500kb!");return o},s=(a,o,c)=>{let l="1-img-0";const m=c.length-1;if(i.imgList.length>0){const j=i.imgList[i.imgList.length-1].id.split("-"),p=parseInt(j[j.length-1])+1;j.pop(),l=[...j,p].join("-")}const d={id:l,name:c[m].name,img:URL.createObjectURL(c[m])},x=[...i.imgList,d];console.log("imageList",x),a.setFieldValue(o.name,x)},t=(a,o,c)=>{let l=D(i.imgList);l=l.filter(m=>m.id!==c.id),a.setFieldValue(o.name,l)};return e.jsxs(C,{className:"mb-4",children:[e.jsx("h5",{children:"Product Image"}),e.jsx("p",{className:"mb-6",children:"Add or change image for the product"}),e.jsx(u,{children:e.jsx(g,{name:"imgList",children:({field:a,form:o})=>i.imgList.length>0?e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.jsx(le,{imgList:i.imgList,onImageDelete:c=>t(o,a,c)}),e.jsx(k,{draggable:!0,className:"min-h-fit",beforeUpload:r,showList:!1,onChange:c=>s(o,a,c),children:e.jsxs("div",{className:"max-w-full flex flex-col px-4 py-2 justify-center items-center",children:[e.jsx(I,{src:"/img/others/upload.png",darkModeSrc:"/img/others/upload-dark.png"}),e.jsx("p",{className:"font-semibold text-center text-gray-800 dark:text-white",children:"Upload"})]})})]}):e.jsx(k,{draggable:!0,beforeUpload:r,showList:!1,onChange:c=>s(o,a,c),children:e.jsxs("div",{className:"my-16 text-center",children:[e.jsx(I,{className:"mx-auto",src:"/img/others/upload.png",darkModeSrc:"/img/others/upload-dark.png"}),e.jsxs("p",{className:"font-semibold",children:[e.jsxs("span",{className:"text-gray-800 dark:text-white",children:["Drop your image here, or"," "]}),e.jsx("span",{className:"text-blue-500",children:"browse"})]}),e.jsx("p",{className:"mt-1 opacity-60 dark:text-white",children:"Support: jpeg, png"})]})})})})]})},{useUniqueId:de}=se,me=ee().shape({name:w().required("Product Name Required"),price:F().required("Price Required"),stock:F().required("SKU Required"),category:w().required("Category Required")}),ue=({onDelete:n})=>{const[i,r]=f.useState(!1),s=()=>{r(!0)},t=()=>{r(!1)},a=()=>{n==null||n(r)};return e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"text-red-600",variant:"plain",size:"sm",icon:e.jsx(Z,{}),type:"button",onClick:s,children:"Delete"}),e.jsx(L,{isOpen:i,type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:t,onRequestClose:t,onCancel:t,onConfirm:a,children:e.jsx("p",{children:"Are you sure you want to delete this product? All record related to this product will be deleted as well. This action cannot be undone."})})]})},ge=f.forwardRef((n,i)=>{const{type:r,initialData:s={id:"",name:"",productCode:"",img:"",imgList:[],category:"",price:0,stock:0,status:0,costPerItem:0,bulkDiscountPrice:0,taxRate:6,tags:[],brand:"",vendor:"",description:""},onFormSubmit:t,onDiscard:a,onDelete:o}=n,c=de("product-");return e.jsx(e.Fragment,{children:e.jsx(P,{innerRef:i,initialValues:{...s,tags:s!=null&&s.tags?s.tags.map(l=>({label:l,value:l})):[]},validationSchema:me,onSubmit:(l,{setSubmitting:m})=>{const d=D(l);d.tags=d.tags.map(x=>typeof x!="string"?x.value:x),r==="new"&&(d.id=c,d.imgList&&d.imgList.length>0&&(d.img=d.imgList[0].img)),t==null||t(d,m)},children:({values:l,touched:m,errors:d,isSubmitting:x})=>e.jsx(V,{children:e.jsxs(O,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(ae,{touched:m,errors:d}),e.jsx(ie,{touched:m,errors:d}),e.jsx(oe,{touched:m,errors:d,values:l})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(ce,{values:l})})]}),e.jsxs(K,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:r==="edit"&&e.jsx(ue,{onDelete:o})}),e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(N,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>a==null?void 0:a(),children:"Discard"}),e.jsx(N,{size:"sm",variant:"solid",loading:x,icon:e.jsx(_,{}),type:"submit",children:"Save"})]})]})]})})})})});ge.displayName="ProductForm";export{ge as P};
