import{j as e,$ as w,d as K,r as L,Q as O,T as $,a1 as Q,U as X,V as q,f as P,G as z,w as V,X as W}from"./index-sFzf4xgK.js";import{A as J}from"./AdaptableCard-ZmpuYt9J.js";import{C as Y}from"./Views-cMR82yL4.js";import{T as C}from"./index-4XDMr0G4.js";import{B as Z}from"./Button-7VCVZJfX.js";import{B as E}from"./Badge-N86Ykf_U.js";import{C as k}from"./Card-0NcWSoxi.js";import{T as M}from"./Tag-lEthrBg-.js";import{H as S}from"./index-lwixXq3m.js";import{i as D}from"./isLastChild-6BXlVJ47.js";import{A as F}from"./index-l28G_51M.js";import{u as ee,a as se}from"./acronym-Ubf4mZQr.js";import{U as le,R as ae,aq as ce,W as re,Q as te}from"./index.esm-a15joBQq.js";import{c as H}from"./AccountServices-_H39mabR.js";import{C as b}from"./index-mB9DlPfx.js";import{A as ie}from"./Affix-RKCuz81n.js";import{u as ne}from"./useResponsive--AQjFPru.js";import"./mapCloneElement-7aBHhhkl.js";import"./context-_X_Ia2Rl.js";import"./useMergeRef-Rt_Crb27.js";import"./Tooltip-2HBl8IKw.js";import"./index.esm-PEPNg8t8.js";import"./floating-ui.react-xe1dPT16.js";import"./floating-ui.dom-KU0eYpRY.js";import"./index-F1ElV9AB.js";import"./motion-JMywUYCu.js";const h="UPDATE-TICKET",f="COMMENT",u="ADD-TAGS-TO-TICKET",p="ADD-FILES-TO-TICKET",y="COMMENT-MENTION",T="ASSIGN-TICKET",g="CREATE-TICKET",me=[h,f,y,T],oe=[u,p,g],N={0:{label:"Completed",bgClass:"bg-emerald-500",textClass:"text-emerald-500"},1:{label:"In Dev",bgClass:"bg-blue-500",textClass:"text-blue-500"},2:{label:"Ready to test",bgClass:"bg-amber-500",textClass:"text-amber-500"}},R={"Live Issue":"bg-rose-500",Backend:"bg-blue-500",Bug:"bg-amber-400","Low priority":"bg-indigo-500"},n=({value:s})=>e.jsx(e.Fragment,{children:w.unix(s).format("hh:mm A")}),c=({children:s,className:l})=>e.jsx("span",{className:K("font-semibold text-gray-900 dark:text-gray-100",l),children:s}),xe=({data:s,compact:l})=>{var m,d,o,t;const i={replace:r=>{var a,j;return r.type==="tag"&&(r==null?void 0:r.name)==="strong"?e.jsx(c,{children:(a=r==null?void 0:r.children[0])==null?void 0:a.data},(j=r==null?void 0:r.children[0])==null?void 0:j.data):r.data}};switch(s.type){case h:return l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"text-xs",children:e.jsx(n,{value:s.dateTime})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"mx-1",children:"has change "}),e.jsx(c,{children:s.ticket}),e.jsx("span",{className:"mx-1",children:" status to "}),e.jsx(E,{className:N[s.status||0].bgClass}),e.jsx(c,{className:"ml-1 rtl:mr-1",children:N[s.status||0].label})]})]}):e.jsxs("p",{className:"my-1 flex items-center",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"mx-1",children:"has change "}),e.jsx(c,{children:s.ticket}),e.jsx("span",{className:"mx-1",children:" status to "}),e.jsx(E,{className:N[s.status||0].bgClass}),e.jsx(c,{className:"ml-1 rtl:mr-1",children:N[s.status||0].label}),e.jsx("span",{className:"ml-3 rtl:mr-3",children:e.jsx(n,{value:s.dateTime})})]});case f:return e.jsxs(e.Fragment,{children:[l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"text-xs",children:e.jsx(n,{value:s.dateTime})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"mx-1",children:"comment on your"}),e.jsx(c,{children:"Post"})]})]}):e.jsxs("p",{className:"my-1 flex items-center",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"mx-1",children:"comment on your"}),e.jsx(c,{children:"Post"}),e.jsx("span",{className:"ml-3 rtl:mr-3",children:e.jsx(n,{value:s.dateTime})})]}),e.jsx(k,{bordered:!0,className:"mt-4",children:S(s.comment||"",i)})]});case y:return e.jsxs(e.Fragment,{children:[l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"text-xs",children:e.jsx(n,{value:s.dateTime})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"mx-1",children:"mentioned you in a comment"}),e.jsx(c,{children:"Post"})]})]}):e.jsxs("p",{className:"my-1 flex items-center",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"mx-1",children:"mentioned you in a comment"}),e.jsx(c,{children:"Post"}),e.jsx("span",{className:"ml-3 rtl:mr-3",children:e.jsx(n,{value:s.dateTime})})]}),e.jsx(k,{bordered:!0,className:"mt-4",children:S(s.comment||"",i)})]});case u:return l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"text-xs",children:e.jsx(n,{value:s.dateTime})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"mx-1",children:"added tags "}),(m=s==null?void 0:s.tags)==null?void 0:m.map((r,a)=>e.jsx(M,{prefix:!0,className:"mx-1",prefixClass:`${R[r]}`,children:r},r+a))]})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsxs(c,{children:[s.userName," "]}),e.jsx("span",{className:"mx-1",children:"added tags "}),(d=s==null?void 0:s.tags)==null?void 0:d.map((r,a)=>e.jsx(M,{prefix:!0,className:"mx-1",prefixClass:`${R[r]}`,children:r},r+a)),e.jsx("span",{className:"ml-3 rtl:mr-3",children:e.jsx(n,{value:s.dateTime})})]});case p:return l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"text-xs",children:e.jsx(n,{value:s.dateTime})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"mx-1",children:"added"}),(o=s==null?void 0:s.files)==null?void 0:o.map((r,a)=>e.jsxs(c,{children:[r,!D((s==null?void 0:s.files)||[],a)&&e.jsxs("span",{className:"ltr:mr-1 rtl:ml-1",children:[","," "]})]},r+a))]})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsxs(c,{children:[s.userName," "]}),e.jsx("span",{className:"mx-1",children:"added"}),(t=s==null?void 0:s.files)==null?void 0:t.map((r,a)=>e.jsxs(c,{children:[r,!D((s==null?void 0:s.files)||[],a)&&e.jsx("span",{className:"ltr:mr-1 rtl:ml-1",children:", "})]},r+a)),e.jsx("span",{className:"mx-1",children:"to ticket"}),e.jsxs(c,{children:[s.ticket," "]}),e.jsx("span",{className:"ml-3 rtl:mr-3",children:e.jsx(n,{value:s.dateTime})})]});case T:return l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[e.jsx(c,{children:s.userName}),e.jsx("span",{className:"text-xs",children:e.jsx(n,{value:s.dateTime})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"mx-1",children:"assigned ticket"}),e.jsx(c,{children:s.ticket}),e.jsx("span",{className:"mx-1",children:"to"}),e.jsxs(c,{children:[s==null?void 0:s.assignee," "]})]})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsxs(c,{children:[s.userName," "]}),e.jsx("span",{className:"mx-1",children:"assigned ticket"}),e.jsx(c,{children:s.ticket}),e.jsx("span",{className:"mx-1",children:"to"}),e.jsxs(c,{children:[s.assignee," "]}),e.jsx("span",{className:"ml-3 rtl:mr-3",children:e.jsx(n,{value:s.dateTime})})]});case g:return e.jsxs("div",{className:"flex items-center",children:[e.jsxs(c,{children:[s.userName," "]}),e.jsx("span",{className:"mx-1",children:"has created ticket"}),e.jsx(c,{children:s.ticket}),e.jsx("span",{className:"ml-3 rtl:mr-3",children:e.jsx(n,{value:s.dateTime})})]});default:return null}},de=({type:s})=>{switch(s){case u:return e.jsx(te,{});case p:return e.jsx(re,{});case h:return e.jsx(ce,{});case g:return e.jsx(ae,{});default:return e.jsx(le,{})}},je=({data:s})=>{const l=ee(),i=L.useMemo(()=>({size:30,shape:"circle"}),[]);if(s&&me.includes(s.type)){const m=s.userImg?{src:s.userImg}:{className:`${l(s.userName||"")}`};return e.jsx(F,{...m,...i,children:se(s.userName||"")})}return s&&oe.includes(s.type)?e.jsx(F,{className:"text-gray-700 bg-gray-200 dark:text-gray-100",icon:e.jsx(de,{type:s.type}),...i}):null},I="accountActivityLog",A=O(I+"/getLogs",async s=>(await H(s)).data),v=O(I+"/filterLogs",async s=>(await H(s)).data),he={loading:!1,loadMoreLoading:!1,loadable:!1,activityIndex:1,logs:[],selectedType:[h,f,y,T,u,p,g]},B=$({name:`${I}/state`,initialState:he,reducers:{setActivityIndex:(s,l)=>{s.activityIndex=l.payload},setSelected:(s,l)=>{s.selectedType=l.payload}},extraReducers:s=>{s.addCase(A.fulfilled,(l,i)=>{const m=Q(l);l.logs=[...m.logs,...i.payload.data],l.loadMoreLoading=!1,l.loadable=i.payload.loadable}).addCase(A.pending,l=>{l.loadMoreLoading=!0}).addCase(v.fulfilled,(l,i)=>{l.logs=i.payload.data,l.loading=!1,l.loadable=i.payload.loadable}).addCase(v.pending,l=>{l.loading=!0})}}),{setActivityIndex:G,setSelected:ue}=B.actions,pe=B.reducer,ge=X({data:pe}),x=q,Ne=()=>{const s=P(),l=x(a=>a.accountActivityLog.data.logs),i=x(a=>a.accountActivityLog.data.loading),m=x(a=>a.accountActivityLog.data.loadMoreLoading),d=x(a=>a.accountActivityLog.data.loadable),o=x(a=>a.accountActivityLog.data.selectedType),t=x(a=>a.accountActivityLog.data.activityIndex);L.useEffect(()=>{s(v({filter:o,activityIndex:t}))},[]);const r=()=>{const a=t+1;s(G(a)),s(A({filter:o,activityIndex:a}))};return e.jsx(z,{loading:i,children:e.jsxs("div",{className:"max-w-[900px]",children:[l.map(a=>e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"mb-4 font-semibold uppercase",children:w.unix(a.date).format("dddd, DD MMMM")}),e.jsx(C,{children:V(a.events)?e.jsx(C.Item,{children:"No Activities"}):a.events.map((j,U)=>e.jsx(C.Item,{media:e.jsx(je,{data:j}),children:e.jsx("div",{className:"mt-1",children:e.jsx(xe,{data:j})})},j.type+U))})]},a.id)),e.jsx("div",{className:"text-center",children:d?e.jsx(Z,{loading:m,onClick:r,children:"Load More"}):"No more activity to load"})]})})},ve=[{label:"Comment on post",value:f},{label:"Mentioned you",value:y}],fe=[{label:"Ticket status",value:h},{label:"Assign ticket",value:T},{label:"New ticket",value:g},{label:"Add tags",value:u},{label:"Add files",value:p}],_=({children:s,className:l})=>e.jsx("h6",{className:K("text-gray-900 uppercase tracking-wide font-semibold text-sm lg:text-xs",l),children:s}),ye=()=>{const s=P(),l=x(t=>t.accountActivityLog.data.selectedType),i=x(t=>t.accountActivityLog.data.activityIndex),m=L.useCallback(t=>{s(v({filter:t,activityIndex:1})),i!==1&&s(G(1)),s(ue(t))},[s,i]),{larger:d}=ne(),o=()=>e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"mb-4",children:"Filter Activity"}),e.jsxs(b.Group,{vertical:!0,value:l,onChange:t=>{m(t)},children:[e.jsx(_,{className:"mb-3",children:"Ticket"}),fe.map(t=>e.jsx(b,{className:"mb-4",value:t.value,children:t.label},t.value)),e.jsx(_,{className:"mt-4 mb-3",children:"Comment"}),ve.map(t=>e.jsx(b,{className:"mb-4",value:t.value,children:t.label},t.value))]})]});return e.jsx("div",{children:d.md?e.jsx(ie,{className:"hidden lg:block",offset:80,children:o()}):o()})};W("accountActivityLog",ge);const Te=()=>e.jsx(Y,{children:e.jsx(J,{children:e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8 ",children:[e.jsxs("div",{className:"col-span-4 order-last md:order-first",children:[e.jsx("h3",{className:"mb-6",children:"Activity Log"}),e.jsx(Ne,{})]}),e.jsx(ye,{})]})})}),Ve=Te;export{Ve as default};
